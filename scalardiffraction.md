# 标量衍射计算不完全指南
本文的目的总结一些标量衍射的计算方法，并讨论讨论他们的适用条件。代码和例子在：github.com/sleepingcat

需要的预备知识：涉及的数理知识并不高深，主要是线性系统和傅里叶变换（离散傅里叶变换）的基础知识，当然还有光学。

涉及的内容：准确地说，应该是讨论基于快速傅里叶变换（FFT）的标量衍射，其顺序是
* 菲涅尔衍射
* 角谱衍射
* 夫琅禾费衍射
* 单步菲涅尔衍射
* 两步菲涅尔衍射
* 其他（未来补充）

本文的重点并不在标量衍射的推导，所以跳过麦克斯韦方程组，和参考文献类似，直接到跳到第一类瑞利-索末菲积分
$$
U_2(x, y)=\frac{1}{j \lambda} \iint_{\Sigma} U_1(\xi, \eta) \frac{z}{r_{12}} \frac{\exp \left(j k r_{12}\right)}{r_{12}} d \xi d \eta
$$
$\lambda$ 表示波长，$k=2\pi$ $(x, y)$ 和 $(\xi, \eta)$ 分别是入射屏面和观察平面的 坐标，$U_1$ 和 $U_2$ 分别是入射面和出射面的复振幅分布。
$\Sigma$ 为衍射孔径， $z$ 是两个平面的距离，$ r_{12}=\sqrt{z^2+(x-\xi)^2+(y-\eta)^2} $。

![Alt text](fig/fig1.png)

当然，我们可以直接计算这个积分。假设采样数为 $N\times N$，这个积分的计算复杂度为$ \mathcal{O}(N^4）$。而基于 FFT 的算法时间复杂度可以降到 $ \mathcal{O}(N^2\log{N}) $，假如 $ N=1024 $ 时，基于 FFT 算法需要的时间是 1分钟，那么积分方法可能要算上一整天。

## 瑞利-索末菲/角谱衍射

$$
U_2(x, y)=\iint U_1(\xi, \eta) h(x-\xi, y-\eta) d \xi d \eta,
$$